# RAG 기반 AI 답변 생성 계획서

## 1. 개요
- 기능 설명: 벡터 검색(RAG)을 활용한 AI 자동 답변 생성 시스템으로, 기존 강의 콘텐츠를 기반으로 질문에 대한 정확한 답변을 제공
- 해결하려는 문제:
  - 반복적인 질문에 대한 신속한 답변 제공 부족
  - 강의 자료의 체계적 활용 미비
  - 24시간 답변 서비스의 필요성

## 2. 핵심 요구사항

### 기능적 요구사항
- FR-01: 질문 텍스트를 벡터로 변환하여 저장해야 한다
- FR-02: 강의 콘텐츠를 청크 단위로 분할하여 벡터 임베딩해야 한다
- FR-03: 질문과 관련도가 높은 강의 청크를 검색할 수 있어야 한다
- FR-04: 검색된 강의 내용을 기반으로 AI 답변을 생성해야 한다
- FR-05: AI 답변에는 참고한 강의 출처를 포함해야 한다
- FR-06: 생성된 AI 답변은 관리자 승인 후 공개되어야 한다
- FR-07: 크론 작업을 통해 새로운 질문에 대해 자동으로 AI 답변을 생성해야 한다

### 비기능적 요구사항
- 성능: 벡터 유사도 검색 응답시간 < 1초
- 품질: AI 답변의 강의 내용 일치도 > 80%
- 확장성: 새로운 강의 콘텐츠 추가 시 자동 임베딩 처리

## 3. 용어 정의

| 용어 | 영문 | 설명 |
|------|------|------|
| RAG | Retrieval-Augmented Generation | 검색 증강 생성, 관련 문서를 찾아 답변을 생성하는 AI 기법 |
| 임베딩 | Embedding | 텍스트를 고차원 벡터로 변환한 것 (768차원) |
| 청크 | Chunk | 강의 콘텐츠를 의미 단위로 분할한 조각 |
| 벡터 검색 | Vector Search | 임베딩 간 코사인 유사도를 이용한 유사 문서 검색 |
| 강의 청크 | Lecture Chunk | lecture_chunks 테이블에 저장된 강의 콘텐츠 조각 |

## 4. 범위

### 포함
- Gemini text-embedding-004 모델을 이용한 임베딩 생성
- PostgreSQL pgvector 확장을 이용한 벡터 유사도 검색
- 질문-강의 매칭 알고리즘 구현
- AI 답변 생성 프롬프트 설계
- 크론 스케줄링을 통한 자동 답변 생성
- 강의 출처 참조 시스템

### 제외
- 실시간 답변 생성 (크론 기반으로만 동작)
- 사용자 맞춤형 답변 (일반적인 답변만 제공)
- 이미지/동영상 기반 질문 처리
- 다국어 지원

## 5. 성공 기준

- [ ] 질문 등록 시 embedding 벡터가 자동으로 생성된다
- [ ] 강의 콘텐츠가 청크 단위로 분할되어 lecture_chunks 테이블에 저장된다
- [ ] 벡터 유사도 검색으로 관련 강의 청크를 찾을 수 있다
- [ ] 검색된 강의 내용을 바탕으로 AI 답변이 생성된다
- [ ] AI 답변에 참고한 강의 정보(강의명, 주차)가 포함된다
- [ ] 생성된 AI 답변은 is_approved=false로 저장되어 관리자 검토를 거친다
- [ ] 크론 작업이 정기적으로 미답변 질문에 대해 AI 답변을 생성한다
- [ ] 벡터 인덱스 최적화로 검색 성능이 보장된다